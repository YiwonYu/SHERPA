nohup: ignoring input
[Fri Feb 27 20:29:54 UTC 2026] Waiting for PanFusion processes to finish...
PIDs: 469437 469630 469631 469632 469633 469634 469635 469636
[Fri Feb 27 20:29:54 UTC 2026] All PanFusion processes finished.
[Fri Feb 27 20:29:54 UTC 2026] Waiting 10s for GPU memory to be released...
[Fri Feb 27 20:30:04 UTC 2026] Starting UniPano inference...
Using Python: /venv/panfusion/bin/python
Backing up stale config: /workspace/UniPano/logs/ud4lfpye/config.yaml -> /workspace/UniPano/logs/ud4lfpye/config.yaml.bak
Using 8 GPUs (0,1,2,3,4,5,6,7) per seed with DDP
Wrote 550 prompts to /workspace/UniPano/data/demo_from_jsonl.txt
Running seed 0 on GPUs 0,1,2,3,4,5,6,7
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
Seed set to 0
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
`Trainer(limit_predict_batches=1.0)` was configured so 100% of the batches will be used..
[rank: 0] Seed set to 0
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/lightning/fabric/__init__.py:41: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/transformers/transformer_2d.py:34: FutureWarning: `Transformer2DModelOutput` is deprecated and will be removed in version 1.0.0. Importing `Transformer2DModelOutput` from `diffusers.models.transformer_2d` is deprecated and this will be removed in a future version. Please use `from diffusers.models.modeling_outputs import Transformer2DModelOutput`, instead.
  deprecate("Transformer2DModelOutput", "1.0.0", deprecation_message)
[rank: 2] Seed set to 0
[rank: 1] Seed set to 0
[rank: 3] Seed set to 0
[rank: 6] Seed set to 0
[rank: 4] Seed set to 0
[rank: 5] Seed set to 0
[rank: 7] Seed set to 0
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 2] Seed set to 0
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 1] Seed set to 0
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 3] Seed set to 0
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 4] Seed set to 0
Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 6] Seed set to 0
Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 5] Seed set to 0
Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/8
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/attention_processor.py:2086: FutureWarning: Using LoRAAttnProcessor is deprecated. Please use the PEFT backend for all things LoRA. You can install PEFT by running `pip install peft`.
  deprecate("LoRAAttnProcessor", "0.30.0", deprecation_message, standard_warn=False)
/venv/panfusion/lib/python3.9/site-packages/diffusers/models/lora.py:208: FutureWarning: `LoRALinearLayer` is deprecated and will be removed in version 1.0.0. Use of `LoRALinearLayer` is deprecated. Please switch to PEFT backend by installing PEFT: `pip install peft`.
  deprecate("LoRALinearLayer", "1.0.0", deprecation_message)
[rank: 7] Seed set to 0
Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/8
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

wandb: WARNING The anonymous setting has no effect and will be removed in a future version.
wandb: Tracking run with wandb version 0.25.0
wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
wandb: Run data is saved locally in logs/ud4lfpye/wandb/offline-run-20260227_203055-ud4lfpye
wandb: Detected [huggingface_hub.inference] in use.
wandb: Use W&B Weave for improved LLM call tracing. Install Weave with `pip install weave` then add `import weave` to the top of your script.
wandb: For more information, check out the docs at: https://weave-docs.wandb.ai/
Restoring states from the checkpoint path at /workspace/UniPano/logs/ud4lfpye/checkpoints/last.ckpt
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 5 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 4 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 7 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 6 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Traceback (most recent call last):
  File "/workspace/UniPano/main.py", line 106, in <module>
    cli_main()
  File "/workspace/UniPano/main.py", line 87, in cli_main
    cli = MyLightningCLI(
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 863, in predict
    return call._call_and_handle_interrupt(
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 902, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 962, in _run
    self.strategy.setup(self)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/strategies/ddp.py", line 177, in setup
    _sync_module_states(self.model)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/overrides/distributed.py", line 171, in _sync_module_states
    torch_sync_module_states(
  File "/venv/panfusion/lib/python3.9/site-packages/torch/distributed/utils.py", line 142, in _sync_module_states
    _sync_params_and_buffers(
  File "/venv/panfusion/lib/python3.9/site-packages/torch/distributed/utils.py", line 160, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 258.00 MiB (GPU 0; 23.53 GiB total capacity; 4.04 GiB already allocated; 90.12 MiB free; 4.11 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Traceback (most recent call last):
  File "/workspace/UniPano/main.py", line 106, in <module>
    cli_main()
  File "/workspace/UniPano/main.py", line 87, in cli_main
    cli = MyLightningCLI(
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/cli.py", line 394, in __init__
    self._run_subcommand(self.subcommand)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/cli.py", line 701, in _run_subcommand
    fn(**fn_kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 863, in predict
    return call._call_and_handle_interrupt(
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/strategies/launchers/subprocess_script.py", line 105, in launch
    return function(*args, **kwargs)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 902, in _predict_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/trainer/trainer.py", line 962, in _run
    self.strategy.setup(self)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/strategies/ddp.py", line 177, in setup
    _sync_module_states(self.model)
  File "/venv/panfusion/lib/python3.9/site-packages/lightning/pytorch/overrides/distributed.py", line 171, in _sync_module_states
    torch_sync_module_states(
  File "/venv/panfusion/lib/python3.9/site-packages/torch/distributed/utils.py", line 142, in _sync_module_states
    _sync_params_and_buffers(
  File "/venv/panfusion/lib/python3.9/site-packages/torch/distributed/utils.py", line 160, in _sync_params_and_buffers
    dist._broadcast_coalesced(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 258.00 MiB (GPU 0; 23.53 GiB total capacity; 4.04 GiB already allocated; 90.12 MiB free; 4.11 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync logs/ud4lfpye/wandb/offline-run-20260227_203055-ud4lfpye[0m
